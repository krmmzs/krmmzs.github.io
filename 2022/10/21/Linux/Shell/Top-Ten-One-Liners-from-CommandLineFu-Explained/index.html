<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":true,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="Top Ten One-Liners from CommandLineFu Explained I love working in the shell. Mastery of shell lets you get things done in seconds, rather than minutes or hours, if you chose to write a program instead">
<meta property="og:type" content="article">
<meta property="og:title" content="Top_Ten_One-Liners_from_CommandLineFu_Explained">
<meta property="og:url" content="http://example.com/2022/10/21/Linux/Shell/Top-Ten-One-Liners-from-CommandLineFu-Explained/index.html">
<meta property="og:site_name" content="krmmzs">
<meta property="og:description" content="Top Ten One-Liners from CommandLineFu Explained I love working in the shell. Mastery of shell lets you get things done in seconds, rather than minutes or hours, if you chose to write a program instead">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="https://catonmat.net/wp-content/uploads/2010/03/commandlinefu-explained.jpg">
<meta property="article:published_time" content="2022-10-21T06:37:44.000Z">
<meta property="article:modified_time" content="2022-10-21T08:15:36.813Z">
<meta property="article:author" content="krmmzs">
<meta property="article:tag" content="Shell">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://catonmat.net/wp-content/uploads/2010/03/commandlinefu-explained.jpg">

<link rel="canonical" href="http://example.com/2022/10/21/Linux/Shell/Top-Ten-One-Liners-from-CommandLineFu-Explained/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : false,
    isPost : true,
    lang   : 'en'
  };
</script>

  <title>Top_Ten_One-Liners_from_CommandLineFu_Explained | krmmzs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">krmmzs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content post posts-expand">
            

    
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/21/Linux/Shell/Top-Ten-One-Liners-from-CommandLineFu-Explained/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h1 class="post-title" itemprop="name headline">
          Top_Ten_One-Liners_from_CommandLineFu_Explained
        </h1>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-21 14:37:44 / Modified: 16:15:36" itemprop="dateCreated datePublished" datetime="2022-10-21T14:37:44+08:00">2022-10-21</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
        <h1 id="Top-Ten-One-Liners-from-CommandLineFu-Explained"><a href="#Top-Ten-One-Liners-from-CommandLineFu-Explained" class="headerlink" title="Top Ten One-Liners from CommandLineFu Explained"></a>Top Ten One-Liners from CommandLineFu Explained</h1><hr>
<p><img src="https://catonmat.net/wp-content/uploads/2010/03/commandlinefu-explained.jpg" alt="CommandLineFu Explained">I love working in the shell. Mastery of shell lets you get things done in seconds, rather than minutes or hours, if you chose to write a program instead.</p>
<p>In this article I’d like to explain the <a target="_blank" rel="noopener" href="http://www.commandlinefu.com/commands/browse/sort-by-votes">top one-liners</a> from the <a target="_blank" rel="noopener" href="http://www.commandlinefu.com/">commandlinefu.com</a>. It’s a user-driven website where people get to choose the best and most useful shell one-liners.</p>
<p>But before I do that, I want to take the opportunity and link to a few of my articles that I wrote some time ago on working efficiently in the command line:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/bash-vi-editing-mode-cheat-sheet">Working Efficiently in Bash (Part I).</a></li>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/bash-emacs-editing-mode-cheat-sheet">Working Efficiently in Bash (Part II).</a></li>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/the-definitive-guide-to-bash-command-line-history">The Definitive Guide to Bash Command Line History.</a></li>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/set-operations-in-unix-shell">A fun article on Set Operations in the Shell.</a></li>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/solving-google-treasure-hunt-prime-number-problem-four">Another fun article on Solving Google Treasure Hunt in the Shell.</a></li>
</ul>
<p>And now the explanation of top one-liners from commandlinefu.</p>
<h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><ul>
<li><a href="#1-run-the-last-command-as-root">Run the last command as root</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">sudo !!</span><br></pre></td></tr></table></figure></li>
<li><a href="#2-serve-the-current-directory-at-httplocalhost8000">Serve the current directory at http://localhost:8000/</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">python -m http.server</span><br></pre></td></tr></table></figure></li>
<li><a href="#3-save-a-file-you-edited-in-vim-without-the-needed-permissions">Save a file you edited in vim without the needed permissions</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:w !sudo <span class="built_in">tee</span> %</span><br></pre></td></tr></table></figure></li>
<li><a href="#4-change-to-the-previous-working-directory">Change to the previous working directory</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cd</span> -</span><br></pre></td></tr></table></figure></li>
<li><a href="#5-run-the-previous-shell-command-but-replace-string-foo-with-bar">Run the previous shell command but replace string “foo” with “bar”</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">^foo^bar^</span><br></pre></td></tr></table></figure></li>
<li><a href="#6-quickly-backup-or-copy-a-file">Quickly backup or copy a file</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">cp</span> file&#123;,.bak&#125;</span><br></pre></td></tr></table></figure></li>
<li><a href="#8-find-the-last-command-that-begins-with-whatever-but-avoid-running-it">Find the last command that begins with</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">!whatever:p</span><br></pre></td></tr></table></figure></li>
<li><a href="#9-copy-your-public-key-to-remote-machine-for-public-key-authentication">Copy your public-key to remote-machine for public-key authentication</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ssh-copy-id remote-machine</span><br></pre></td></tr></table></figure></li>
<li><a href="#10-capture-video-of-a-linux-desktop">Capture video of a linux desktop</a><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -f x11grab -s wxga -r 25 -i :0.0 -sameq output.avi</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="1-Run-the-last-command-as-root"><a href="#1-Run-the-last-command-as-root" class="headerlink" title="#1. Run the last command as root"></a>#1. Run the last command as root</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ sudo !!</span><br></pre></td></tr></table></figure>

<p>We all know what the <code>sudo</code> command does - it runs the command as another user, in this case, it runs the command as superuser because no other user was specified. But what’s really interesting is the bang-bang <code>!!</code> part of the command. It’s called the <strong>event designator</strong>. An event designator references a command in shell’s history. In this case the event designator references the previous command. Writing <code>!!</code> is the same as writing <code>!-1</code>. The <code>-1</code> refers to the last command. You can generalize it, and write <code>!-n</code> to refer to the n-th previous command. To view all your previous commands, type <code>history</code>.</p>
<p>This one-liner is actually really bash-specific, as event designators are a feature of bash.</p>
<p>I wrote about event designators in much more detail in my article “<a target="_blank" rel="noopener" href="https://catonmat.net/the-definitive-guide-to-bash-command-line-history">The Definitive Guide to Bash Command Line History</a>.” The article also comes with a printable cheat sheet for working with the history.</p>
<h2 id="2-Serve-the-current-directory-at-http-localhost-8000"><a href="#2-Serve-the-current-directory-at-http-localhost-8000" class="headerlink" title="#2. Serve the current directory at http://localhost:8000/"></a>#2. Serve the current directory at <a target="_blank" rel="noopener" href="http://localhost:8000/">http://localhost:8000/</a></h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python -m http.server</span><br></pre></td></tr></table></figure>

<p>This one-liner starts a web server on port 8000 with the contents of current directory on all the interfaces (address 0.0.0.0), not just localhost. If you have “<code>index.html</code>“ or “<code>index.htm</code>“ files, it will serve those, otherwise it will list the contents of the currently working directory.</p>
<p>It works because python comes with a standard module called <code>SimpleHTTPServer</code>. The <code>-m</code> argument makes python to search for a module named <code>SimpleHTTPServer.py</code> in all the possible system locations (listed in <code>sys.path</code> and <code>$PYTHONPATH</code> shell variable). Once found, it executes it as a script. If you look at the source code of this module, you’ll find that this module tests if it’s run as a script <code>if **name** == &#39;**main**&#39;</code>, and if it is, it runs the <code>test()</code> method that makes it run a web server in the current directory.</p>
<p>To use a different port, specify it as the next argument:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ python -m http.server 8080</span><br></pre></td></tr></table></figure>

<p>This command runs a HTTP server on all local interfaces on port 8080.</p>
<h2 id="3-Save-a-file-you-edited-in-vim-without-the-needed-permissions"><a href="#3-Save-a-file-you-edited-in-vim-without-the-needed-permissions" class="headerlink" title="#3. Save a file you edited in vim without the needed permissions"></a>#3. Save a file you edited in vim without the needed permissions</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">:w !sudo tee %</span><br></pre></td></tr></table></figure>

<p>This happens to me way too often. I open a system config file in vim and edit it just to find out that I don’t have permissions to save it. This one-liner saves the day. Instead of writing the while to a temporary file <code>:w /tmp/foobar</code> and then moving the temporary file to the right destination <code>mv /tmp/foobar /etc/service.conf</code>, you now just type the one-liner above in vim and it will save the file.</p>
<p>Here is how it works, if you look at the vim documentation (by typing <code>:he :w</code> in vim), you’ll find the reference to the command <code>:w !&#123;cmd&#125;</code> that says that vim runs <code>&#123;cmd&#125;</code> and passes it the contents of the file as standard input. In this one-liner the <code>&#123;cmd&#125;</code> part is the <code>sudo tee %</code> command. It runs <code>tee %</code> as superuser. But wait, what is <code>%</code>? Well, it’s a read-only register in vim that contains the filename of the current file! Therefore the command that vim executes becomes <code>tee current_filename</code>, with the current directory being whatever the <code>current_file</code> is in. Now what does <code>tee</code> do? The <code>tee</code> command takes standard input and write it to a file! Rephrasing, it takes the contents of the file edited in vim, and writes it to the file (while being root)! All done!</p>
<h2 id="4-Change-to-the-previous-working-directory"><a href="#4-Change-to-the-previous-working-directory" class="headerlink" title="#4. Change to the previous working directory"></a>#4. Change to the previous working directory</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cd -</span><br></pre></td></tr></table></figure>

<p>Everyone knows this, right? The dash “<code>-</code>“ is short for “previous working directory.” The previous working directory is defined by <code>$OLDPWD</code> shell variable. After you use the <code>cd</code> command, it sets the <code>$OLDPWD</code> environment variable, and then, if you type the short version <code>cd -</code>, it effectively becomes <code>cd $OLDPWD</code> and changes to the previous directory.</p>
<p>To change to a directory named “<code>-</code>“, you have to either cd to the parent directory and then do <code>cd ./-</code> or do <code>cd /full/path/to/-</code>.</p>
<h2 id="5-Run-the-previous-shell-command-but-replace-string-“foo”-with-“bar”"><a href="#5-Run-the-previous-shell-command-but-replace-string-“foo”-with-“bar”" class="headerlink" title="#5. Run the previous shell command but replace string “foo” with “bar”"></a>#5. Run the previous shell command but replace string “foo” with “bar”</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ^foo^bar^</span><br></pre></td></tr></table></figure>

<p>This is another event designator. This one is for quick substitution. It replaces <code>foo</code> with <code>bar</code> and repeats the last command. It’s actually a shortcut for <code>!!:s/foo/bar/</code>. This one-liner applies the <code>s</code> modifier to the <code>!!</code> event designator. As we learned from one-liner #1, the <code>!!</code> event designator stands for the previous command. Now the <code>s</code> modifier stands for substitute (greetings to <a target="_blank" rel="noopener" href="https://catonmat.net/sed-one-liners-explained-part-one">sed</a>) and it substitutes the first word with the second word.</p>
<p>Note that this one-liner replaces just the first word in the previous command. To replace all words, add the <code>g</code> modifer (<code>g</code> for global):</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ !!:gs/foo/bar</span><br></pre></td></tr></table></figure>

<p>This one-liner is also bash-specific, as event designators are a feature of bash.</p>
<p>Again, see my article “<a target="_blank" rel="noopener" href="https://catonmat.net/the-definitive-guide-to-bash-command-line-history">The Definitive Guide to Bash Command Line History</a>.” I explain all this stuff in great detail.</p>
<h2 id="6-Quickly-backup-or-copy-a-file"><a href="#6-Quickly-backup-or-copy-a-file" class="headerlink" title="#6. Quickly backup or copy a file"></a>#6. Quickly backup or copy a file</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ cp filename&#123;,.bak&#125;</span><br></pre></td></tr></table></figure>

<p>This one-liner copies the file named <code>filename</code> to a file named <code>filename.bak</code>. Here is how it works. It uses <strong>brace expansion</strong> to construct a list of arguments for the <code>cp</code> command. Brace expansion is a mechanism by which arbitrary strings may be generated. In this one-liner <code>filename&#123;,.bak&#125;</code> gets brace expanded to <code>filename filename.bak</code> and puts in place of the brace expression. The command becomes <code>cp filename filename.bak</code> and file gets copied.</p>
<p>Talking more about brace expansion, you can do all kinds of combinatorics with it. Here is a fun application:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ echo &#123;a,b,c&#125;&#123;a,b,c&#125;&#123;a,b,c&#125;</span><br></pre></td></tr></table></figure>

<p>It generates all the possible strings 3-letter from the set <code>&#123;a, b, c&#125;</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">aaa aab aac aba abb abc aca acb acc</span><br><span class="line">baa bab bac bba bbb bbc bca bcb bcc</span><br><span class="line">caa cab cac cba cbb cbc cca ccb ccc</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>And here is how to generate all the possible 2-letter strings from the set of <code>&#123;a, b, c&#125;</code>:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">$ echo &#123;a,b,c&#125;&#123;a,b,c&#125;</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>It produces:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">aa ab ac ba bb bc ca cb cc</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>If you liked this, you may also like my article where I defined a bunch of set operations (such as intersection, union, symmetry, powerset, etc) by using just shell commands. The article is called “<a target="_blank" rel="noopener" href="https://catonmat.net/set-operations-in-unix-shell">Set Operations in the Unix Shell</a>.” (And since I have sets in the shell, I will soon write articles on on “<strong>Combinatorics in the Shell</strong>“ and “<strong>Algebra in the Shell</strong>“. Fun topics to explore. Perhaps even “Topology in the Shell” :))</p>
<h2 id="7-mtr-traceroute-and-ping-combined"><a href="#7-mtr-traceroute-and-ping-combined" class="headerlink" title="#7. mtr - traceroute and ping combined"></a>#7. mtr - traceroute and ping combined</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ mtr google.com</span><br></pre></td></tr></table></figure>

<p>MTR, bettern known as “Matt’s Traceroute” combines both <code>traceroute</code> and <code>ping</code> command. After each successful hop, it sends a ping request to the found machine, this way it produces output of both <code>traceroute</code> and <code>ping</code> to better understand the quality of link. If it finds out a packet took an alternative route, it displays it, and by default it keeps updating the statistics so you knew what was going on in real time.</p>
<h2 id="8-Find-the-last-command-that-begins-with-“whatever-”-but-avoid-running-it"><a href="#8-Find-the-last-command-that-begins-with-“whatever-”-but-avoid-running-it" class="headerlink" title="#8. Find the last command that begins with “whatever,” but avoid running it"></a>#8. Find the last command that begins with “whatever,” but avoid running it</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ !whatever:p</span><br></pre></td></tr></table></figure>

<p>Another use of event designators. The <code>!whatever</code> designator searches the shell history for the most recently executed command that starts with <code>whatever</code>. But instead of executing it, it prints it. The <code>:p</code> modifier makes it print instead of executing.</p>
<p>This one-liner is bash-specific, as event designators are a feature of bash.</p>
<p>Once again, see my article “<a target="_blank" rel="noopener" href="https://catonmat.net/the-definitive-guide-to-bash-command-line-history">The Definitive Guide to Bash Command Line History</a>.” I explain all this stuff in great detail.</p>
<h2 id="9-Copy-your-public-key-to-remote-machine-for-public-key-authentication"><a href="#9-Copy-your-public-key-to-remote-machine-for-public-key-authentication" class="headerlink" title="#9. Copy your public-key to remote-machine for public-key authentication"></a>#9. Copy your public-key to remote-machine for public-key authentication</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ssh-copy-id remote-machine</span><br></pre></td></tr></table></figure>

<p>This one-liner copies your public-key, that you generated with <code>ssh-keygen</code> (either SSHv1 file identity.pub or SSHv2 file id_rsa.pub) to the <code>remote-machine</code> and places it in <code>~/.ssh/authorized_keys</code> file. This ensures that the next time you try to log into that machine, public-key authentication (commonly referred to as “passwordless authentication.”) will be used instead of the regular password authentication.</p>
<p>If you wanted to do it yourself, you’d have to take the following steps:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">your-machine$ scp ~/.ssh/identity.pub remote-machine:</span><br><span class="line">your-machine$ ssh remote-machine</span><br><span class="line">remote-machine$ cat identity.pub &gt;&gt; ~/.ssh/authorized_keys</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>This one-liner saves a great deal of typing. Actually I just found out that there was a shorter way to do it:</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">your-machine$ ssh remote-machine &#x27;cat &gt;&gt; .ssh/authorized_keys&#x27; &lt; .ssh/identity.pub</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h2 id="10-Capture-video-of-a-linux-desktop"><a href="#10-Capture-video-of-a-linux-desktop" class="headerlink" title="#10. Capture video of a linux desktop"></a>#10. Capture video of a linux desktop</h2><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ ffmpeg -f x11grab -s wxga -r 25 -i :0.0 -sameq /tmp/out.mpg</span><br></pre></td></tr></table></figure>

<p>A pure coincidence, I have done so much video processing with ffmpeg that I know what most of this command does without looking much in the manual.</p>
<p>The ffmpeg generally can be descibed as a command that takes a bunch of options and the last option is the output file. In this case the options are <code>-f x11grab -s wxga -r 25 -i :0.0 -sameq</code> and the output file is <code>/tmp/out.mpg</code>.</p>
<p>Here is what the options mean:</p>
<ul>
<li><code>-f x11grab</code> makes ffmpeg to set the input video format as x11grab. The X11 framebuffer has a specific format it presents data in and it makes ffmpeg to decode it correctly.</li>
<li><code>-s wxga</code> makes ffmpeg to set the size of the video to wxga which is shortcut for 1366x768. This is a strange resolution to use, I’d just write <code>-s 800x600</code>.</li>
<li><code>-r 25</code> sets the framerate of the video to 25fps.</li>
<li><code>-i :0.0</code> sets the video input file to X11 display 0.0 at localhost.</li>
<li><code>-sameq</code> preserves the quality of input stream. It’s best to preserve the quality and post-process it later.</li>
</ul>
<p>You can also specify ffmpeg to grab display from another x-server by changing the <code>-i :0.0</code> to <code>-i host:0.0</code>.</p>
<p>If you’re interested in ffmpeg, here are my other articles on ffmpeg that I wrote while ago:</p>
<ul>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/how-to-extract-audio-tracks-from-youtube-videos">How to Extract Audio Tracks from YouTube Videos</a></li>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/converting-youtube-flvs-to-a-better-format-with-ffmpeg">Converting YouTube Flash Videos to a Better Format with ffmpeg</a></li>
</ul>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><a target="_blank" rel="noopener" href="https://catonmat.net/top-ten-one-liners-from-commandlinefu-explained">Top Ten One-Liners from CommandLineFu Explained</a></li>
</ul>

    </div>

    
    
    

      <footer class="post-footer">
          <div class="post-tags">
              <a href="/tags/Shell/" rel="tag"># Shell</a>
          </div>

        


        
    <div class="post-nav">
      <div class="post-nav-item">
    <a href="/2022/10/20/Anime/Do-It-Yourself/" rel="prev" title="Do_It_Yourself">
      <i class="fa fa-chevron-left"></i> Do_It_Yourself
    </a></div>
      <div class="post-nav-item">
    <a href="/2022/10/21/Linux/Linux-Shell-scripts-cookbook/Linux-Shell-scripts-cookbook-Shell-Something-Out/" rel="next" title="Linux_Shell_scripts_cookbook_Shell_Something_Out">
      Linux_Shell_scripts_cookbook_Shell_Something_Out <i class="fa fa-chevron-right"></i>
    </a></div>
    </div>
      </footer>
    
  </article>
  
  
  



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
          <div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#Top-Ten-One-Liners-from-CommandLineFu-Explained"><span class="nav-number">1.</span> <span class="nav-text">Top Ten One-Liners from CommandLineFu Explained</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#Overview"><span class="nav-number">1.1.</span> <span class="nav-text">Overview</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#1-Run-the-last-command-as-root"><span class="nav-number">1.2.</span> <span class="nav-text">#1. Run the last command as root</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2-Serve-the-current-directory-at-http-localhost-8000"><span class="nav-number">1.3.</span> <span class="nav-text">#2. Serve the current directory at http:&#x2F;&#x2F;localhost:8000&#x2F;</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3-Save-a-file-you-edited-in-vim-without-the-needed-permissions"><span class="nav-number">1.4.</span> <span class="nav-text">#3. Save a file you edited in vim without the needed permissions</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4-Change-to-the-previous-working-directory"><span class="nav-number">1.5.</span> <span class="nav-text">#4. Change to the previous working directory</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5-Run-the-previous-shell-command-but-replace-string-%E2%80%9Cfoo%E2%80%9D-with-%E2%80%9Cbar%E2%80%9D"><span class="nav-number">1.6.</span> <span class="nav-text">#5. Run the previous shell command but replace string “foo” with “bar”</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6-Quickly-backup-or-copy-a-file"><span class="nav-number">1.7.</span> <span class="nav-text">#6. Quickly backup or copy a file</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7-mtr-traceroute-and-ping-combined"><span class="nav-number">1.8.</span> <span class="nav-text">#7. mtr - traceroute and ping combined</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8-Find-the-last-command-that-begins-with-%E2%80%9Cwhatever-%E2%80%9D-but-avoid-running-it"><span class="nav-number">1.9.</span> <span class="nav-text">#8. Find the last command that begins with “whatever,” but avoid running it</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#9-Copy-your-public-key-to-remote-machine-for-public-key-authentication"><span class="nav-number">1.10.</span> <span class="nav-text">#9. Copy your public-key to remote-machine for public-key authentication</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#10-Capture-video-of-a-linux-desktop"><span class="nav-number">1.11.</span> <span class="nav-text">#10. Capture video of a linux desktop</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#References"><span class="nav-number">1.12.</span> <span class="nav-text">References</span></a></li></ol></li></ol></div>
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">krmmzs</p>
  <div class="site-description" itemprop="description">233</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">44</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">23</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">34</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>
  <div class="links-of-author motion-element">
      <span class="links-of-author-item">
        <a href="https://github.com/krmmzs" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;krmmzs" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a>
      </span>
      <span class="links-of-author-item">
        <a href="mailto:belliyan250@gmail.com" title="E-Mail → mailto:belliyan250@gmail.com" rel="noopener" target="_blank"><i class="fa fa-envelope fa-fw"></i>E-Mail</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://www.youtube.com/channel/UCh2c-Y0OmoDUfeZHomm_Llg" title="YouTube → https:&#x2F;&#x2F;www.youtube.com&#x2F;channel&#x2F;UCh2c-Y0OmoDUfeZHomm_Llg" rel="noopener" target="_blank"><i class="fab fa-youtube fa-fw"></i>YouTube</a>
      </span>
      <span class="links-of-author-item">
        <a href="https://t.me/krmmzs" title="Telegram → https:&#x2F;&#x2F;t.me&#x2F;krmmzs" rel="noopener" target="_blank"><i class="fab fa-telegram fa-fw"></i>Telegram</a>
      </span>
  </div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">krmmzs</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
