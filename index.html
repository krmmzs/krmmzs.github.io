<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 6.3.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Muse","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="233">
<meta property="og:type" content="website">
<meta property="og:title" content="krmmzs">
<meta property="og:url" content="http://example.com/index.html">
<meta property="og:site_name" content="krmmzs">
<meta property="og:description" content="233">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="krmmzs">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>krmmzs</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">krmmzs</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
      <p class="site-subtitle" itemprop="description">blog</p>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/26/LeetCode-862-Shortest-Subarray-with-Sum-at-Least-K/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/26/LeetCode-862-Shortest-Subarray-with-Sum-at-Least-K/" class="post-title-link" itemprop="url">LeetCode 862. Shortest Subarray with Sum at Least K</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-10-26 23:12:25" itemprop="dateCreated datePublished" datetime="2022-10-26T23:12:25+08:00">2022-10-26</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-10-27 00:34:59" itemprop="dateModified" datetime="2022-10-27T00:34:59+08:00">2022-10-27</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="LeetCode-862-Shortest-Subarray-with-Sum-at-Least-K"><a href="#LeetCode-862-Shortest-Subarray-with-Sum-at-Least-K" class="headerlink" title="LeetCode 862. Shortest Subarray with Sum at Least K"></a>LeetCode 862. Shortest Subarray with Sum at Least K</h1><p>久违的算法题解</p>
<p>铁子某课给的题目，虽然当时实在无心写。</p>
<p>传送门：</p>
<p><a target="_blank" rel="noopener" href="https://leetcode.com/problems/shortest-subarray-with-sum-at-least-k/">LeetCode 862. Shortest Subarray with Sum at Least K</a></p>
<h2 id="Main-Idea"><a href="#Main-Idea" class="headerlink" title="Main Idea"></a>Main Idea</h2><blockquote>
<p>A subarray is a contiguous part of an array.</p>
</blockquote>
<p>其实我刚开始看成了 <code>subsequence</code>…</p>
<p>现在看一下此案是subarray…</p>
<pre>
             |--> sum >= k, shortest subarray
             |
        |----------| subarray
|-------------------------------------| array
</pre>

<p>献祭出我的字符画。</p>
<p>Pay attention:</p>
<blockquote>
<p>-10^5 &lt;&#x3D; nums[i] &lt;&#x3D; 10^5</p>
</blockquote>
<p>这说明前缀和不单调，没有双指针玩咯… see <a target="_blank" rel="noopener" href="https://leetcode.com/problems/minimum-size-subarray-sum/">LeetCode 209. Minimum Size Subarray Sum</a></p>
<p><del>好，快跑</del></p>
<p>那就先想暴力，枚举所有区间<br>等价于枚举区间的两端， 我习惯枚举右端点</p>
<p>然后区间快速查询这肯定得来个前后和吧</p>
<pre>
        j          i
|-------|----------|------------------| array
</pre>

<p>Need to promise that $S_{i} - S_{j} &gt;&#x3D; k$ and $i - j$ is minimum(si is array of prefix sum)</p>
<p>问题就转化为了 si sj k 三者的关系</p>
<p>为了减少枚举的次数，需要在枚举的过程中将一些不可能解给pass掉</p>
<pre>
Sx
^
|       /
|      /--> Sj >= Si
|     /
|    /--> Si
|   /
|  /
| /
|
|------------------> x
</pre>

<p>如果存在t &gt; i, 满足St - Sj &gt;&#x3D; k, 因为Si &lt; Sj(肯定也满足&gt;&#x3D; k), 且i 距离后面的t更近(数组长度更小)，<br>所以i更好, 所以那些Sj &gt;&#x3D; Si的j们都可以pass掉了</p>
<pre>
Sx
^
|
|
|
|    /--> Si
|   /
|  /
| /
|
|------------------> x
</pre>

<p>这就意味着，当找到一个Si的时候，可以把Si的都干没掉</p>
<p>那么我们需要一个数据结构来维护这个Sx</p>
<p><strong>队列能维护顺序，单调性能保证首尾的max和min<br>所以可以用单调队列来维护数据</strong></p>
<p>维护了一个单调队列以后，找到一个Si（队列里的max）的时候<br>可以在队列里找到一个Sj（队列里的min）满足Si - Sj &gt;&#x3D; k<br>都要枚举一遍(从最小开始枚举比较自然)<br>这里定义个说法：<br>如果Sj可以和Si满足上述的不等式我们就说i和j配对</p>
<p>如果可以找到个j和i配对，那么一定比接下来加入到队列里的i（max）更好<br>因为i更小，距离更近, 那么j就可以从单调队列里删除掉了。</p>
<p>这样的操作，能满足所有的元素只会出队一次，入队一次， 所以时间复杂度是O(n)</p>
<p>很显然，这样的单调队列不是典型的，需要现场分析</p>
<h2 id="Code"><a href="#Code" class="headerlink" title="Code"></a>Code</h2><p>or see <a target="_blank" rel="noopener" href="https://github.com/krmmzs/Leetcode/blob/master/0862-shortest-subarray-with-sum-at-least-k-hcfy-anchor/0862-shortest-subarray-with-sum-at-least-k-hcfy-anchor.cpp">github</a></p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">typedef</span> <span class="type">long</span> <span class="type">long</span> LL; <span class="comment">// will bigger than int</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Solution</span> &#123;</span><br><span class="line">    <span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="type">int</span> <span class="title">shortestSubarray</span><span class="params">(vector&lt;<span class="type">int</span>&gt;&amp; nums, <span class="type">int</span> k)</span> </span>&#123;</span><br><span class="line">        vector&lt;<span class="type">int</span>&gt;::size_type n = nums.<span class="built_in">size</span>();</span><br><span class="line">        <span class="function">vector&lt;LL&gt; <span class="title">s</span><span class="params">(n + <span class="number">1</span>)</span></span>;</span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">            s[i] = s[i - <span class="number">1</span>] + nums[i - <span class="number">1</span>];</span><br><span class="line">        &#125;</span><br><span class="line">        deque&lt;<span class="type">int</span>&gt; q; <span class="comment">// contains index, not value</span></span><br><span class="line">        q.<span class="built_in">push_back</span>(<span class="number">0</span>);</span><br><span class="line">        <span class="type">int</span> res = INT_MAX;</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">1</span>; i &lt;= n; i ++) &#123;</span><br><span class="line">            <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; s[i] - s[q.<span class="built_in">front</span>()] &gt;= k) &#123;</span><br><span class="line">                res = <span class="built_in">min</span>(res, i - q.<span class="built_in">front</span>());</span><br><span class="line">                q.<span class="built_in">pop_front</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            <span class="keyword">while</span> (!q.<span class="built_in">empty</span>() &amp;&amp; s[i] &lt;= s[q.<span class="built_in">back</span>()]) &#123;</span><br><span class="line">                q.<span class="built_in">pop_back</span>();</span><br><span class="line">            &#125;</span><br><span class="line">            q.<span class="built_in">push_back</span>(i);</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="keyword">if</span> (res == INT_MAX) <span class="keyword">return</span> <span class="number">-1</span>;</span><br><span class="line">        <span class="keyword">return</span> res;</span><br><span class="line">    &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/26/Docker-change-container-s-mounts/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/26/Docker-change-container-s-mounts/" class="post-title-link" itemprop="url">Docker-change-container's-mounts</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-26 00:09:46 / Modified: 00:19:31" itemprop="dateCreated datePublished" datetime="2022-10-26T00:09:46+08:00">2022-10-26</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Docker/" itemprop="url" rel="index"><span itemprop="name">Docker</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Docker-change-container’s-mounts"><a href="#Docker-change-container’s-mounts" class="headerlink" title="Docker change container’s mounts"></a>Docker change container’s mounts</h1><h2 id="Problem"><a href="#Problem" class="headerlink" title="Problem"></a>Problem</h2><p>I have a container that I want to change the mount point of a volume.</p>
<h2 id="Solution-Fake"><a href="#Solution-Fake" class="headerlink" title="Solution (Fake)"></a>Solution (Fake)</h2><ol>
<li>Stop the container</li>
<li>Remove the container</li>
<li>Run the container with the new mount point</li>
</ol>
<p><strong>stop!!!!!!</strong></p>
<p>这样又要重做container了, yadang～</p>
<h2 id="Solution-Real"><a href="#Solution-Real" class="headerlink" title="Solution (Real)"></a>Solution (Real)</h2><p>直接改配置</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">docker ps -a <span class="comment"># 查看container id or name</span></span><br><span class="line">docker inspect --format=<span class="string">&#x27;&#123;&#123;json .Mounts&#125;&#125;&#x27;</span> container_name(or <span class="built_in">id</span>) <span class="comment"># 查看挂载目录</span></span><br></pre></td></tr></table></figure>

<p>will get</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">        <span class="attr">&quot;Type&quot;</span><span class="punctuation">:</span> <span class="string">&quot;volume&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;volume_name&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Source&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/var/lib/docker/volumes/volume_name/_data&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Destination&quot;</span><span class="punctuation">:</span> <span class="string">&quot;/var/www/html&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Driver&quot;</span><span class="punctuation">:</span> <span class="string">&quot;local&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Mode&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;RW&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">        <span class="attr">&quot;Propagation&quot;</span><span class="punctuation">:</span> <span class="string">&quot;&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>

<p> 把 docker 服务停止了：</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl stop docker</span><br></pre></td></tr></table></figure>

<p> 在 <code>/var/lib/docker/containers/container-ID/config.v2.json</code> 中找到 <strong>MountPoints</strong>，并修改挂载路径<br> （找目录可能要sudo 或者进入root）</p>
<p>重启 docker 服务:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">systemctl start docker</span><br></pre></td></tr></table></figure>

<p>重启 docker 容器</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">docker restart container_name(or <span class="built_in">id</span>)</span><br></pre></td></tr></table></figure>

<p>然后进挂载的目录，发现目录已经变了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/25/rand-Considered-Harmful/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/25/rand-Considered-Harmful/" class="post-title-link" itemprop="url">rand-Considered-Harmful</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-25 18:58:02 / Modified: 20:29:51" itemprop="dateCreated datePublished" datetime="2022-10-25T18:58:02+08:00">2022-10-25</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cpp/" itemprop="url" rel="index"><span itemprop="name">Cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>最近我在阅读Accelerated C++的时候，有道标注了diffcult的习题:</p>
<blockquote>
<p>7-9. (difficult) The implementation of nrand in §7.4.4&#x2F;135 will not work for arguments greater than RAND_MAX. Usually, this restriction is no problem, because RAND_MAX is often the largest possible integer anyway. Nevertheless, there are implementations under which RAND_MAX is much smaller than the largest possible integer. For example, it is not uncommon for RAND_MAX to be 32767 (2^15 -1) and the largest possible integer to be 2147483647 (2^31 -1). Reimplement nrand so that it works well for all values of n.</p>
</blockquote>
<p>其中，被要求更改的程序如下：</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">nrand</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span> || n &gt; RAND_MAX)</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">domain_error</span>(<span class="string">&quot;Argument to nrand is out of range&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> bucket_size = RAND_MAX / n;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> r = <span class="built_in">rand</span>() / bucket_size;</span><br><span class="line">    <span class="keyword">while</span> (r &gt;= n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>上述要被修改的程序其实本身就是对cpp的rand()的一个规避程序(为了不使用rand() % n)。</p>
<p>书中给出的原因：</p>
<blockquote>
<p>The most important reason is pragmatic: rand() really returns only pseudo-random<br>numbers. Many C++ implementations’ pseudo-random-number generators give remainders<br>that aren’t very random when the quotients are small integers. For example, it is not<br>uncommon for successive results of rand() to be alternately even and odd. In that case, if<br>n is 2, successive results of rand() % n will alternate between 0 and 1.</p>
</blockquote>
<blockquote>
<p>There is another, more subtle reason to avoid using rand() % n: If the value of n is large<br>and RAND_MAX is not evenly divisible by n, some remainders will appear more often than<br>others.</p>
</blockquote>
<p>然后给出上述需要被修改的程序的解释：</p>
<blockquote>
<p>To avoid these pitfalls, we’ll use a different strategy, by dividing the range of available<br>random numbers into buckets of exactly equal size. Then we can compute a random number<br>and return the number of the corresponding bucket. Because the buckets are of equal size,<br>some random numbers may not fall into any bucket at all. In that case, we keep asking for<br>forrandom numbers until we get one that fits.</p>
</blockquote>
<p>给了一个例子：<br>假如n &#x3D; 3, 这样<code>bucket_size</code> &#x3D; 10922<br>这样就产生了[0, 10922), [10922, 21844), [21844, 32767), [32767, RAND_MAX)四个区间，其中最后一个区间的最大值是RAND_MAX，所以最后一个区间的值是不会被使用的。</p>
<p>If you look up <a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/numeric/random/rand">C++ documentation on rand()</a>,<br>you’ll see that it returns “a pseudo-random integral value<br>between 0 and RAND_MAX.” <a target="_blank" rel="noopener" href="https://en.cppreference.com/w/cpp/numeric/random/RAND_MAX">Click again</a> on RAND_MAX and you’ll<br>see that “This value is implementation dependent.<br>It’s guaranteed that this value is at least 32767.”</p>
<p>所以是非常有必要进行修改的(codeforces的机器就是32767)。</p>
<h2 id="Solution-Thinking"><a href="#Solution-Thinking" class="headerlink" title="Solution Thinking"></a>Solution Thinking</h2><p>顺着作者给出的思路，分区间。</p>
<p>假设 n 会大于 RAND_MAX, 我们应该首先计算大于RAND_MAX的数字的桶的数量。</p>
<p>它首先计算大于RAND_MAX的数字的桶的数量，并为每个桶计算一个随机数。<br>最后一个桶将有一个介于[0, n % RAND_MAX]之间的随机数，<br>其他桶将有一个介于[0, RAND_MAX]之间的随机数。</p>
<p>给个例子：<br>假设 n &#x3D; 1000000000, RAND_MAX &#x3D; 32767(2^15 - 1)<br>那么我们需要计算的桶的数量为 1000000000 &#x2F; 32767 &#x3D; 30569<br>最后一个桶的随机数的范围为[0, 1000000000 % 32767] &#x3D; [0, 32766]<br>其他桶的随机数的范围为[0, RAND_MAX] &#x3D; [0, 32767]</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">int</span> <span class="title">nrand</span><span class="params">(<span class="type">int</span> n)</span></span></span><br><span class="line"><span class="function"></span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span>)</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">domain_error</span>(<span class="string">&quot;Argument to nrand is out of range&quot;</span>);</span><br><span class="line">    </span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> buckets = n / RAND_MAX;</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> last_bucket = RAND_MAX / (n % RAND_MAX);</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> r = <span class="built_in">rand</span>() / last_bucket;</span><br><span class="line">    <span class="keyword">while</span> (r &gt;= n);</span><br><span class="line"></span><br><span class="line">    <span class="comment">// add the remaining buckets for numbers larger than RAND_MAX</span></span><br><span class="line">    <span class="keyword">for</span> (<span class="type">int</span> i = <span class="number">0</span>; i &lt; buckets; ++i) &#123;</span><br><span class="line">        r += <span class="built_in">rand</span>();</span><br><span class="line">    &#125;</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<h2 id="Back-to-the-question-of-cpp-itself"><a href="#Back-to-the-question-of-cpp-itself" class="headerlink" title="Back to the question of cpp itself"></a>Back to the question of cpp itself</h2><p>能够明细看到cpp的rand()的实现是有问题的，<br>不过，它并没有就此打住；random_shuffle()也使用了rand()。<br>回顾一下，为了进行随机洗牌，我们需要生成随机索引，直到n，即数组的大小。但是如果rand()只能达到32767，那么如果我们在一个元素明显多于这个数组上调用random_shuffle()会发生什么？</p>
<h2 id="rand-Solution"><a href="#rand-Solution" class="headerlink" title="rand() Solution"></a>rand() Solution</h2><p>别担心，从C++11开始，C++中有更好的随机数生成器可用。<br>你唯一需要记住的是使用包含在<random>头文件中的mt19937。<br>这是一个基于素数219937-1的Mersenne Twister，这也恰好是它的周期。<br>它是一个比rand()质量高得多的RNG，而且速度更快（在自定义调用中，<br>从mt19937生成和添加108个数字需要389毫秒，而rand()需要1170毫秒）。<br>它还能在0和232-1&#x3D;4294967295之间产生完整的32位无符号输出，而不是最大限度的32767。</p>
<p>为了取代random_shuffle()，你现在可以调用shuffle()并传入你的mt19937作为第三个参数；shuffle算法将使用你提供的生成器进行洗牌。</p>
<h2 id="C-11-Solution"><a href="#C-11-Solution" class="headerlink" title="C++11 Solution"></a>C++11 Solution</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;random&gt;</span></span></span><br><span class="line"><span class="meta">#<span class="keyword">include</span> <span class="string">&lt;functional&gt;</span></span></span><br><span class="line"></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">rand_generator</span><span class="params">()</span> </span>&#123;</span><br><span class="line">    <span class="function">std::mt19937 <span class="title">mt</span><span class="params">(<span class="number">1729</span>)</span></span>;</span><br><span class="line">    <span class="function">std::uniform_int_distribution&lt;<span class="type">int</span>&gt; <span class="title">dist</span><span class="params">(<span class="number">0</span>, <span class="number">99</span>)</span></span>;</span><br><span class="line">    <span class="keyword">auto</span> generator = std::<span class="built_in">bind</span>(dist, mt);</span><br><span class="line">    <span class="type">int</span> random = <span class="built_in">generator</span>();</span><br><span class="line">    <span class="keyword">return</span> random;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>explanation:</p>
<p>1729 is Deterministic 32-bit seed<br>mt is this engnie object: [0, $2^{32}$]<br>dist is this distribution object: <a href="%E4%BB%A5%E7%A6%BB%E6%95%A3%E5%9E%8B%E5%9D%87%E5%8C%80%E5%88%86%E5%B8%83%E6%96%B9%E5%BC%8F%E4%BA%A7%E7%94%9Fint%E4%B9%B1%E6%95%B0%EF%BC%8C%E8%8C%83%E5%9B%B4%E8%90%BD%E5%9C%A80%E5%88%B099">0, 99</a><br>dist(mt) is mean: Run engine, viewed through distribution<br>bind （利用bind将随机数生产引擎和分布组合成一个随机生成物件）</p>
<h2 id="References"><a href="#References" class="headerlink" title="References"></a>References</h2><ul>
<li><p><a target="_blank" rel="noopener" href="https://codeforces.com/blog/entry/61587">rand-Considered-Harmful</a></p>
</li>
<li><p><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/C%2B%2B11#Extensible_random_number_facility">C++11 Wiki Extensible random number facility</a></p>
</li>
</ul>
<p>如果想要看字幕<a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=LDPMpc-ENqY">youtube</a>也有</p>
<h2 id="More"><a href="#More" class="headerlink" title="More"></a>More</h2><p><a target="_blank" rel="noopener" href="http://xoshiro.di.unimi.it/">If you want even faster, higher-quality random number generators, take a look at this site by Sebastiano Vigna.</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/25/Accelerated-Cpp-chapter07/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/25/Accelerated-Cpp-chapter07/" class="post-title-link" itemprop="url">Accelerated_Cpp_chapter07</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-25 17:49:27 / Modified: 19:58:15" itemprop="dateCreated datePublished" datetime="2022-10-25T17:49:27+08:00">2022-10-25</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cpp/" itemprop="url" rel="index"><span itemprop="name">Cpp</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cpp/Accelerated-Cpp/" itemprop="url" rel="index"><span itemprop="name">Accelerated Cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="chapter-07-Using-associative-containers"><a href="#chapter-07-Using-associative-containers" class="headerlink" title="chapter 07 Using associative containers"></a>chapter 07 Using associative containers</h1><h2 id="Overview"><a href="#Overview" class="headerlink" title="Overview"></a>Overview</h2><h2 id="sequence-containers-vs-associative-containers"><a href="#sequence-containers-vs-associative-containers" class="headerlink" title="sequence containers vs associative containers"></a>sequence containers vs associative containers</h2><p>Another important difference between associative and sequential containers is that, because<br>associative containers are self-ordering, our own programs must not do anything tha<br>changes the order of the elements.</p>
<p>For that reason, <strong>algorithms that change the contents of</strong><br><strong>containers often don’t work for associative containers</strong>. In exchange for that restriction,<br>associative containers offer a variety of useful operations that are impossible to implement<br>implementefficiently for sequential containers.</p>
<h2 id="map’s-key-is-const"><a href="#map’s-key-is-const" class="headerlink" title="map’s key is const"></a>map’s key is const</h2><p>Note that the <strong>pair</strong> associated with a <strong>map</strong> has a key type that is <strong>const</strong>.<br>key is <strong>const</strong>, we are prevented from changing the value of an element’s key. If the key<br>were not <strong>const</strong>, we might implicitly change the element’s position within the <strong>map</strong>.<br>Accordingly, the key is always <strong>const</strong>, so that if we dereference a <code>map&lt;string, int&gt;</code><br>iterator, we get a <code>pair&lt;const string, int&gt;</code>.</p>
<h2 id="high-order-function-let-function-be-a-interface"><a href="#high-order-function-let-function-be-a-interface" class="headerlink" title="high order function let function be a interface"></a>high order function let function be a interface</h2><p>Rather than using <strong>split</strong> directly, we’re going to make it a parameter to the cross-reference<br>function. That way, we leave open the possibility of changing the way we find the words on a<br>line. For example, we could pass the <strong>find_urls</strong> function from §6.1.3&#x2F;105, and use the<br>cross-reference function to see where URLs appear in the input.</p>
<h2 id="rand-function"><a href="#rand-function" class="headerlink" title="rand function"></a>rand function</h2><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// return a random integer in the rang [0, n)</span></span><br><span class="line"><span class="function"><span class="type">int</span> <span class="title">nrand</span><span class="params">(<span class="type">int</span> n)</span> </span>&#123;</span><br><span class="line">    <span class="keyword">if</span> (n &lt;= <span class="number">0</span> || n &gt; RAND_MAX)</span><br><span class="line">        <span class="keyword">throw</span> <span class="built_in">domain_error</span>(<span class="string">&quot;Argument to nrand is out of range&quot;</span>);</span><br><span class="line"></span><br><span class="line">    <span class="type">const</span> <span class="type">int</span> bucket_size = RAND_MAX / n;</span><br><span class="line">    <span class="type">int</span> r;</span><br><span class="line"></span><br><span class="line">    <span class="keyword">do</span> r = <span class="built_in">rand</span>() / bucket_size;</span><br><span class="line">    <span class="keyword">while</span> (r &gt;= n);</span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> r;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>for example:<br>assume that n is 3. Then bucket_size will be 10922. In this case,<br>values of rand() in the range [0, 10922) will yield 0, values in the range [10922,<br>21844) will yield 1, values in the range [21844, 32766) will yield 2, and values of 32766<br>or 32767 will be discarded.</p>
<h2 id="access-operator-will-create-a-new-element-in-map"><a href="#access-operator-will-create-a-new-element-in-map" class="headerlink" title="[] access operator will create a new element in map"></a>[] access operator will create a new element in map</h2><p>Indexes the <strong>map</strong> using a key, <strong>k</strong>, of type <strong>K</strong>, and returns an <strong>lvalue</strong> of type <strong>V</strong>. If there is no<br>entry for the given key, a new value-initialized element is created and inserted into the<br><strong>map</strong> with this key.<br>Because using <strong>[]</strong> to access a <strong>map</strong> might create a new element, <strong>[]</strong> is<br>not allowed on a <strong>const map</strong>.</p>
<p><a target="_blank" rel="noopener" href="https://zh.cppreference.com/w/cpp/container/map/operator_at">std::map&lt;Key,T,Compare,Allocator&gt;::operator[] in cppreference.com</a></p>
<blockquote>
<p>Returns a reference to the value that is mapped to a key equivalent to key, performing an insertion if such key does not already exist.</p>
</blockquote>
<p><strong>a reference to the value obviously is a lvalue.</strong></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/24/Telegram-webm-to-gif/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/24/Telegram-webm-to-gif/" class="post-title-link" itemprop="url">Telegram webm to gif</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-24 18:12:39 / Modified: 20:01:58" itemprop="dateCreated datePublished" datetime="2022-10-24T18:12:39+08:00">2022-10-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Anime/" itemprop="url" rel="index"><span itemprop="name">Anime</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Anime/FFmpeg/" itemprop="url" rel="index"><span itemprop="name">FFmpeg</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Telegram-webm-to-gif"><a href="#Telegram-webm-to-gif" class="headerlink" title="Telegram webm to gif"></a>Telegram webm to gif</h1><h2 id="1-Download-webm"><a href="#1-Download-webm" class="headerlink" title="1. Download webm"></a>1. Download webm</h2><p><a target="_blank" rel="noopener" href="https://t.me/DownloadStickersBot">https://t.me/DownloadStickersBot</a></p>
<p>这个机器人可以下载 Telegram 的 sticker.</p>
<p>简介： Download your favourite stickers in jpg,png,webp formats or whole pack as zip file.</p>
<p>然后就会把zip发送到你的电脑上，解压后就是webm文件。</p>
<h2 id="2-Convert-webm-to-gif"><a href="#2-Convert-webm-to-gif" class="headerlink" title="2. Convert webm to gif"></a>2. Convert webm to gif</h2><p>文件：webmToGif.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> *.webm; <span class="keyword">do</span></span><br><span class="line">    ffmpeg -i <span class="string">&quot;<span class="variable">$i</span>&quot;</span> -pix_fmt rgb24 <span class="string">&quot;<span class="variable">$&#123;i%.webm&#125;</span>.gif&quot;</span>; </span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>将webmToGif.sh放到webm文件夹下，然后执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x webmToGif.sh</span><br><span class="line">./webmToGif.sh</span><br></pre></td></tr></table></figure>

<p>就会把webm文件夹下的所有webm文件转换为gif文件。</p>
<h2 id="3-reduce-gif-size"><a href="#3-reduce-gif-size" class="headerlink" title="3. reduce gif size"></a>3. reduce gif size</h2><p>文件：reduceGifSize.sh</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#!/bin/bash</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> *.gif; <span class="keyword">do</span></span><br><span class="line">    gifsicle -optimize=3 <span class="string">&quot;<span class="variable">$i</span>&quot;</span> -o <span class="string">&quot;<span class="variable">$&#123;i%.gif&#125;</span>_reduced.gif&quot;</span>;</span><br><span class="line"><span class="keyword">done</span></span><br></pre></td></tr></table></figure>

<p>在同一个目录下执行</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">chmod</span> +x reduceGifSize.sh</span><br><span class="line">./reduceGifSize.sh</span><br></pre></td></tr></table></figure>

<h2 id="Reference"><a href="#Reference" class="headerlink" title="Reference"></a>Reference</h2><p><a target="_blank" rel="noopener" href="https://askubuntu.com/questions/506670/how-to-do-i-convert-an-webm-video-to-a-animated-gif-on-the-command-line">Ubuntu ask How to do I convert a webm(video) to a (animated) gif on the command line?</a></p>
<p><a target="_blank" rel="noopener" href="https://www.ffmpeg.org/doxygen/3.3/group__lavc__misc__pixfmt.html">FFmpeg Pixel formats</a></p>
<p><a target="_blank" rel="noopener" href="https://github.com/kohler/gifsicle">gifsicle</a></p>
<p><a target="_blank" rel="noopener" href="https://gist.github.com/Potherca/18423260e2c9a4324c9ecb0c0a284066">Potherca&#x2F;README.md</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/24/Effective-Cpp-00Intro/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/24/Effective-Cpp-00Intro/" class="post-title-link" itemprop="url">Effective Cpp 00 Intro</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-10-24 08:58:31" itemprop="dateCreated datePublished" datetime="2022-10-24T08:58:31+08:00">2022-10-24</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-10-25 12:07:36" itemprop="dateModified" datetime="2022-10-25T12:07:36+08:00">2022-10-25</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cpp/" itemprop="url" rel="index"><span itemprop="name">Cpp</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Cpp/Effective-cpp/" itemprop="url" rel="index"><span itemprop="name">Effective cpp</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Effective-cpp-00-Introduction"><a href="#Effective-cpp-00-Introduction" class="headerlink" title="Effective cpp 00 Introduction"></a>Effective cpp 00 Introduction</h1><h2 id="Introduction"><a href="#Introduction" class="headerlink" title="Introduction"></a>Introduction</h2><h3 id="Terminology"><a href="#Terminology" class="headerlink" title="Terminology"></a>Terminology</h3><h3 id="signature-differences-when-read-this-book"><a href="#signature-differences-when-read-this-book" class="headerlink" title="signature differences when read this book"></a>signature differences when read this book</h3><p>每个函数的声明揭示其签名式(signature)，也就是参数和返回类型。一个函数<br>的签名等同于该函数的类型。</p>
<p><strong>Sometimes signature includes the return type, sometimes it doesn’t.</strong></p>
<p>More see <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/290038/is-the-return-type-part-of-the-function-signature">Is the return type part of the function signature?</a></p>
<p>C++对签名式的官方定义并不包括函数的返回类型，不过本书把返回类型视为签名的一部分，这样比较有帮助。</p>
<h3 id="keyword-explicit"><a href="#keyword-explicit" class="headerlink" title="keyword explicit"></a>keyword <code>explicit</code></h3><p>explicit关键字只能用于构造函数的声明中，用于阻止隐式转换。</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">B</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">B</span><span class="params">(<span class="type">int</span> x = <span class="number">0</span>, <span class="type">bool</span> b = <span class="literal">true</span>)</span></span>; <span class="comment">// default constructor;</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">C</span>&#123;</span><br><span class="line"><span class="keyword">public</span>:</span><br><span class="line">    <span class="function"><span class="keyword">explicit</span> <span class="title">C</span><span class="params">(<span class="type">int</span> x)</span></span>;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>

<p>The constructors for classes B and C are declared explicit here. That<br>prevents them from being used to perform implicit type conversions,<br>though they may still be used for explicit type conversions</p>
<p>More see <a target="_blank" rel="noopener" href="https://stackoverflow.com/questions/121162/what-does-the-explicit-keyword-mean">What does the explicit keyword mean?</a></p>
<h3 id="the-“-x3D-”-syntax-can-also-be-used-to-call-the-copy-constructor"><a href="#the-“-x3D-”-syntax-can-also-be-used-to-call-the-copy-constructor" class="headerlink" title="the “&#x3D;” syntax can also be used to call the copy constructor"></a>the “&#x3D;” syntax can also be used to call the copy constructor</h3><figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">Widget w3 = w2;</span><br></pre></td></tr></table></figure>

<p>Fortunately,  copy  construction  is  easy  to  distinguish  from  copy  as-<br>signment. If a new object is being defined (such as w3 in the statement<br>above), a constructor has to be called; it can’t be an assignment. If no<br>new object is being defined (such as in the “w1&#x3D; w2” statement above),<br>no constructor can be involved, so it’s an assignment.</p>
<p>The copy constructor is a particularly important function, because it<br>defines how an object is passed by value. For example, consider this:</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="type">bool</span> <span class="title">asAcceptableQuality</span><span class="params">(Widget w)</span></span>;</span><br><span class="line"><span class="comment">// ...</span></span><br><span class="line">Widget aWidge;</span><br><span class="line"><span class="keyword">if</span> (<span class="built_in">hasAcceptableQuality</span>(aWidget))</span><br><span class="line">    <span class="comment">// ...</span></span><br></pre></td></tr></table></figure>

<p>The parameter w is passed to hasAcceptableQuality by value, so in the<br>call above, aWidget is copied into w. The copying is done by Widget’s<br>copy  constructor.</p>
<h3 id="function-objects"><a href="#function-objects" class="headerlink" title="function  objects"></a>function  objects</h3><p>objects that act like function.</p>
<p>STL</p>
<h3 id="undefined-behavior"><a href="#undefined-behavior" class="headerlink" title="undefined behavior"></a>undefined behavior</h3><p>The C++ standard doesn’t define what happens when you do something</p>
<figure class="highlight cpp"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">int</span> *p = <span class="number">0</span>; <span class="comment">// p is a null pointer</span></span><br><span class="line">std::cout &lt;&lt; *p; <span class="comment">// dereference a null pointer</span></span><br><span class="line">                 <span class="comment">// yields undefined behavior</span></span><br><span class="line"></span><br><span class="line"><span class="type">char</span> name[] = <span class="string">&quot;Darla&quot;</span>; <span class="comment">// name is an array of size 6(don&#x27;t for get the trailing null!)</span></span><br><span class="line">                       <span class="comment">// yields undefined behavior</span></span><br></pre></td></tr></table></figure>

<h3 id="Cpp-without-interface-language-element"><a href="#Cpp-without-interface-language-element" class="headerlink" title="Cpp without interface(language element)"></a>Cpp without interface(language element)</h3><p>when talking about interfaces in cpp as a fairly general de-sign idea.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/24/cszh-en-table/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/24/cszh-en-table/" class="post-title-link" itemprop="url">cszh-en table</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-24 08:28:37 / Modified: 08:30:48" itemprop="dateCreated datePublished" datetime="2022-10-24T08:28:37+08:00">2022-10-24</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/English/" itemprop="url" rel="index"><span itemprop="name">English</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <img src="../images/csen-zh01.png" alt="csen-zh01" style="zoom:70%;" />
<img src="../images/csen-zh02.png" alt="csen-zh02" style="zoom:70%;" />
<img src="../images/csen-zh03.png" alt="csen-zh03" style="zoom:70%;" />
<img src="../images/csen-zh04.png" alt="csen-zh04" style="zoom:70%;" />
<img src="../images/csen-zh05.png" alt="csen-zh05" style="zoom:70%;" />
<img src="../images/csen-zh06.png" alt="csen-zh06" style="zoom:70%;" />

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/23/ffmpeg-crop-anime-Bocchi-the-Rock-record/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/23/ffmpeg-crop-anime-Bocchi-the-Rock-record/" class="post-title-link" itemprop="url">ffmpeg crop anime Bocchi the Rock record</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-10-23 16:40:16" itemprop="dateCreated datePublished" datetime="2022-10-23T16:40:16+08:00">2022-10-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-10-24 18:10:04" itemprop="dateModified" datetime="2022-10-24T18:10:04+08:00">2022-10-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Anime/" itemprop="url" rel="index"><span itemprop="name">Anime</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Anime/FFmpeg/" itemprop="url" rel="index"><span itemprop="name">FFmpeg</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ffmpeg-crop-anime-Bocchi-the-Rock-record"><a href="#ffmpeg-crop-anime-Bocchi-the-Rock-record" class="headerlink" title="ffmpeg crop anime Bocchi the Rock record"></a>ffmpeg crop anime Bocchi the Rock record</h1><p>Bocchi the Rock实在是太好看了，想裁一些片段玩。</p>
<h2 id="Record"><a href="#Record" class="headerlink" title="Record"></a>Record</h2><p>还没写脚本，所以操作有点笨拙。</p>
<p>先是产生缩略图</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i 2.mp4 -vf <span class="string">&quot;fps=1/10,scale=-2:720&quot;</span> thumbnail-%03d.jpg</span><br></pre></td></tr></table></figure>

<p>直接就是创个interaction.md<br>写下要裁剪的区间<br>然后在这个文本里把命令编辑好到目录下执行<br>在文本里编辑命令的好处是，记录下产生视频的命令, 起到log的作用。</p>
<img src="/images/ffmpeg_bocci_the_rock-01.png" alt="ffmpeg_bocci_the_rock-01" style="zoom:70%;" />

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -ss 00:14:44 -t 40 -i 2.mp4 -vcodec copy -acodec copy 02.mp4</span><br></pre></td></tr></table></figure>

<p>目录下是这些</p>
<img src="/images/ffmpeg_bocci_the_rock-02.png" alt="ffmpeg_bocci_the_rock-02" style="zoom:70%;" />

<p>然后发现了个bug: 起始位置ubuntu22默认视频player黑屏，mpv打开会从-1s开始播放, 估计是关键字没卡上。。</p>
<h2 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h2><p>ffmepg剪切视频，很方便，但是也有很大缺陷：<br>（1）剪切时间点不精确<br>（2）有时剪切的视频开头有黑屏</p>
<p>造成这些问题的原因是ffmpeg无法seek到非关键帧上。</p>
<p>上述的剪切方式比较基本</p>
<h3 id="Parameter-optimization"><a href="#Parameter-optimization" class="headerlink" title="Parameter optimization"></a>Parameter optimization</h3><ul>
<li>将-ss， -t 参数放在-i参数之前(已经这么做了)</li>
</ul>
<p>对输入文件执行seek操作，会seek到-ss设置的时间点前面的关键帧上。</p>
<p>时间不精确，但是不会出现黑屏(然而ubuntu的视频播放器还是黑屏)</p>
<ul>
<li>accurate_seek</li>
</ul>
<p>如果编码格式采用的copy 最好加上 -avoid_negative_ts 1参数</p>
<h3 id="Final-command"><a href="#Final-command" class="headerlink" title="Final command"></a>Final command</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -ss 00:14:44 -t 40 -i 2.mp4 -vcodec copy -acodec copy -avoid_negative_ts 1 02.mp4</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/23/Anime/FFmpeg/ffmpeg-crop-anime-Bocchi-the-Rock-record/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/23/Anime/FFmpeg/ffmpeg-crop-anime-Bocchi-the-Rock-record/" class="post-title-link" itemprop="url">ffmpeg crop anime Bocchi the Rock record</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2022-10-23 16:40:16" itemprop="dateCreated datePublished" datetime="2022-10-23T16:40:16+08:00">2022-10-23</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2022-10-24 18:11:00" itemprop="dateModified" datetime="2022-10-24T18:11:00+08:00">2022-10-24</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Anime/" itemprop="url" rel="index"><span itemprop="name">Anime</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Anime/FFmpeg/" itemprop="url" rel="index"><span itemprop="name">FFmpeg</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="ffmpeg-crop-anime-Bocchi-the-Rock-record"><a href="#ffmpeg-crop-anime-Bocchi-the-Rock-record" class="headerlink" title="ffmpeg crop anime Bocchi the Rock record"></a>ffmpeg crop anime Bocchi the Rock record</h1><p>Bocchi the Rock实在是太好看了，想裁一些片段玩。</p>
<h2 id="Record"><a href="#Record" class="headerlink" title="Record"></a>Record</h2><p>还没写脚本，所以操作有点笨拙。</p>
<p>先是产生缩略图</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -i 2.mp4 -vf <span class="string">&quot;fps=1/10,scale=-2:720&quot;</span> thumbnail-%03d.jpg</span><br></pre></td></tr></table></figure>

<p>直接就是创个interaction.md<br>写下要裁剪的区间<br>然后在这个文本里把命令编辑好到目录下执行<br>在文本里编辑命令的好处是，记录下产生视频的命令, 起到log的作用。</p>
<img src="/images/ffmpeg_bocci_the_rock-01.png" alt="ffmpeg_bocci_the_rock-01" style="zoom:70%;" />

<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -ss 00:14:44 -t 40 -i 2.mp4 -vcodec copy -acodec copy 02.mp4</span><br></pre></td></tr></table></figure>

<p>目录下是这些</p>
<img src="/images/ffmpeg_bocci_the_rock-02.png" alt="ffmpeg_bocci_the_rock-02" style="zoom:70%;" />

<p>然后发现了个bug: 起始位置ubuntu22默认视频player黑屏，mpv打开会从-1s开始播放, 估计是关键字没卡上。。</p>
<h2 id="Fix"><a href="#Fix" class="headerlink" title="Fix"></a>Fix</h2><p>ffmepg剪切视频，很方便，但是也有很大缺陷：<br>（1）剪切时间点不精确<br>（2）有时剪切的视频开头有黑屏</p>
<p>造成这些问题的原因是ffmpeg无法seek到非关键帧上。</p>
<p>上述的剪切方式比较基本</p>
<h3 id="Parameter-optimization"><a href="#Parameter-optimization" class="headerlink" title="Parameter optimization"></a>Parameter optimization</h3><ul>
<li>将-ss， -t 参数放在-i参数之前(已经这么做了)</li>
</ul>
<p>对输入文件执行seek操作，会seek到-ss设置的时间点前面的关键帧上。</p>
<p>时间不精确，但是不会出现黑屏(然而ubuntu的视频播放器还是黑屏)</p>
<ul>
<li>accurate_seek</li>
</ul>
<p>如果编码格式采用的copy 最好加上 -avoid_negative_ts 1参数</p>
<h3 id="Final-command"><a href="#Final-command" class="headerlink" title="Final command"></a>Final command</h3><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">ffmpeg -ss 00:14:44 -t 40 -i 2.mp4 -vcodec copy -acodec copy -avoid_negative_ts 1 02.mp4</span><br></pre></td></tr></table></figure>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2022/10/23/Downloading-a-video-from-the-Internet/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="krmmzs">
      <meta itemprop="description" content="233">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="krmmzs">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2022/10/23/Downloading-a-video-from-the-Internet/" class="post-title-link" itemprop="url">Downloading_a_video_from_the_Internet</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>
              

              <time title="Created: 2022-10-23 02:49:12 / Modified: 03:03:50" itemprop="dateCreated datePublished" datetime="2022-10-23T02:49:12+08:00">2022-10-23</time>
            </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Shell/" itemprop="url" rel="index"><span itemprop="name">Shell</span></a>
                </span>
                  , 
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/Shell/CLI/" itemprop="url" rel="index"><span itemprop="name">CLI</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <h1 id="Downloading-a-video-from-the-Internet"><a href="#Downloading-a-video-from-the-Internet" class="headerlink" title="Downloading a video from the Internet"></a>Downloading a video from the Internet</h1><p>最近突然对shell的使用有了兴趣, 平常一些小操作有积累。<br>这次选了一本一位印度人在20岁写的shell书。</p>
<p>闲暇时间看到1.16之后就乏了（本身不是那种原理书，而是一本实用书），就想着写点东西，顺便练练手。</p>
<p>翻目录，发现了一个下载视频的内容。<br>他介绍的是有一个叫作youtube-dl的视频下载工具<br>可惜现在这工具被针对了，速度堪忧。</p>
<p>替换工具：<br><a target="_blank" rel="noopener" href="https://github.com/yt-dlp/yt-dlp">yt-dlp</a></p>
<p>两者原理都差不多， 通过向服务器发出GET请求（就像浏览器一样）来实现视频下载。<br>它会伪装成浏览器，使得YouTube或其他视频提供商以为这是一台流媒体设备，从而下载到视频。</p>
<p>然后我在rc文件加了些alias，方便使用。</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">alias</span> dvF=<span class="string">&#x27;yt-dlp -F&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> dvf=<span class="string">&#x27;yt-dlp -f&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> dvmp4=<span class="string">&#x27;yt-dlp -f &quot;bestvideo[ext=mp4]+bestaudio[ext=m4a]&quot; --merge-output-format mp4&#x27;</span></span><br><span class="line"><span class="built_in">alias</span> dvmkv=<span class="string">&#x27;yt-dlp -f &quot;bestvideo[ext=mkv]+bestaudio[ext=webm]&quot; --merge-output-format mkv&#x27;</span></span><br></pre></td></tr></table></figure>

<p>dv是download video的缩写，F是-list-formats，f是format的缩写，分别可选mp4，mkv。</p>
<p>更多见<a target="_blank" rel="noopener" href="https://github.com/yt-dlp/yt-dlp#usage-and-options">USAGE AND OPTIONS</a></p>
<p>Example:</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dvmp4 https://www.youtube.com/watch?v=Yd8YGqFdZn8</span><br></pre></td></tr></table></figure>

<p>show</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">[youtube] Yd8YGqFdZn8: Downloading webpage</span><br><span class="line">[youtube] Yd8YGqFdZn8: Downloading android player API JSON</span><br><span class="line">[info] Yd8YGqFdZn8: Downloading 1 format(s): 136+140</span><br><span class="line">[download] Destination: 増えていく『さかな』『ちんあなご』 [Yd8YGqFdZn8].f136.mp4</span><br><span class="line">[download] 100% of    5.15MiB <span class="keyword">in</span> 00:00:02 at 1.82MiB/s</span><br><span class="line">[download] Destination: 増えていく『さかな』『ちんあなご』 [Yd8YGqFdZn8].f140.m4a</span><br><span class="line">[download] 100% of  523.91KiB <span class="keyword">in</span> 00:00:00 at 624.42KiB/s</span><br><span class="line">[Merger] Merging formats into <span class="string">&quot;増えていく『さかな』『ちんあなご』 [Yd8YGqFdZn8].mp4&quot;</span></span><br><span class="line">Deleting original file 増えていく『さかな』『ちんあなご』 [Yd8YGqFdZn8].f140.m4a (pass -k to keep)</span><br><span class="line">Deleting original file 増えていく『さかな』『ちんあなご』 [Yd8YGqFdZn8].f136.mp4 (pass -k to keep)</span><br></pre></td></tr></table></figure>

<p>目录下就有以该视频标题为文件名的mp4文件了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">krmmzs</p>
  <div class="site-description" itemprop="description">233</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">26</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
            <a href="/categories/">
          
        <span class="site-state-item-count">18</span>
        <span class="site-state-item-name">categories</span></a>
      </div>
      <div class="site-state-item site-state-tags">
            <a href="/tags/">
          
        <span class="site-state-item-count">24</span>
        <span class="site-state-item-name">tags</span></a>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2022</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">krmmzs</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://muse.theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Muse</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/muse.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
